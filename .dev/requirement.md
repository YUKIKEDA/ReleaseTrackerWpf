### アプリケーション仕様書：Installer Tracker

#### 1. 概要

本アプリケーションは、ソフトウェアのインストールモジュール（インストーラーや配布ファイル群）のディレクトリ構造を記録し、バージョン間の変更点を視覚的に比較・追跡するためのWPFデスクトップアプリケーションである。

新旧バージョンのモジュール構成を比較することで、意図しないファイルの追加・削除・変更を検出し、リリース品質の向上を支援することを目的とする。

#### 2. アプリケーション名

*   **Installer Tracker** (インストーラートラッカー)

#### 3. 主要機能

1.  **ディレクトリ構造のスキャンと保存**
    *   指定したディレクトリのファイルとフォルダの構造を再帰的にスキャンする。
    *   スキャンした構造情報（ファイル名, パス, サイズ, 更新日時など）をJSON形式のスナップショットファイルとして保存できる。

2.  **スナップショットの読み込み**
    *   過去に保存したJSON形式のスナップショットファイルを「旧構造（比較元）」として読み込むことができる。

3.  **新旧構造の比較**
    *   「旧構造（比較元）」と「新構造（比較先）」の2つのディレクトリ構造を比較し、差分を検出する。
    *   差分は以下のカテゴリで分類される。
        *   **追加 (Added)**: 新構造にのみ存在するファイル/フォルダ。
        *   **削除 (Deleted)**: 旧構造にのみ存在したファイル/フォルダ。
        *   **変更 (Modified)**: 両方に存在するが、サイズや更新日時が異なるファイル。

4.  **比較結果の表示**
    *   比較結果をツリービュー形式で視覚的に表示する。
    *   各差分（追加、削除、変更）は、色分けやアイコンで直感的に識別できるように表示する。

5.  **レポートのエクスポート**
    *   比較結果のレポートを以下の形式でファイルに出力できる。
        *   **Excel (.xlsx)**
        *   **CSV (.csv)**
        *   **テキスト (.txt)**
    *   エクスポートされるファイルには、「ファイルパス」「差分種別」などの情報に加え、**空の「説明(Description)」列**が含まれる。

6.  **説明情報のインポート**
    *   ユーザーがAI（ChatGPT, Gemini等）や手動で「説明」列を追記したExcel/CSVファイルをインポートする機能。
    *   インポートされたファイルに基づき、アプリケーション内の比較結果ツリーの各項目に対応する説明文を表示する。

#### 4. ユーザーインターフェース (UI)

*   **モダンなUIデザイン**: WPF-UIフレームワークを利用し、Fluent Design Systemに準拠したモダンで直感的なUIを提供する。
*   **メインウィンドウの構成**:
    *   **コントロールパネル部**:
        *   「旧構造」エリア：パス入力、フォルダ参照、スキャン実行、スナップショット読み込みのボタンを配置。
        *   「新構造」エリア：パス入力、フォルダ参照、スキャン実行、スナップショット保存のボタンを配置。
        *   「比較実行」ボタン。
    *   **結果表示部**:
        *   比較結果を表示するツリービュー。
        *   レポートの「エクスポート」および「説明のインポート」ボタンを配置。
    *   **ステータスバー**:
        *   現在の処理状況（スキャン中、比較完了など）やエラーメッセージを表示する。
        *   処理中はプログレスリングを表示し、UIのフリーズを防ぐ。

#### 5. 技術仕様

*   **プラットフォーム**: Windows デスクトップ
*   **フレームワーク**: .NET 8 (または .NET 6以降)
*   **UIフレームワーク**: WPF (Windows Presentation Foundation)
*   **主要ライブラリ**:
    *   `CommunityToolkit.Mvvm`: MVVMパターンの実装を簡素化。
    *   `Wpf.Ui`: Fluent Design UIコンポーネントを提供。
    *   `Microsoft.Extensions.Hosting`: 依存性注入(DI)コンテナのセットアップ。
    *   `System.Text.Json`: スナップショット(JSON)のシリアライズ/デシリアライズ。
    *   `ClosedXML`: Excel (.xlsx) 形式でのレポートエクスポート/インポート。(**商用利用可能**)
    *   `CsvHelper`: CSV形式でのレポートエクスポート/インポート。(**商用利用可能**)
*   **設計パターン**: MVVM (Model-View-ViewModel) パターンを採用し、UIロジックとビジネスロジックを分離する。

#### 6. ワークフロー

1.  **旧バージョンの記録 (リリース時など)**
    1.  リリースするインストールモジュールが格納されたフォルダのパスを「新構造」エリアに指定する。
    2.  「このフォルダをスキャン」ボタンをクリック。
    3.  「スキャン結果を保存」ボタンをクリックし、バージョン番号などを含んだ名前（例: `product-v1.0.0.json`）でスナップショットを保存する。

2.  **新旧バージョンの比較 (次期バージョンの確認時)**
    1.  「旧構造」エリアの「ファイルから読み込み」ボタンで、比較したい過去のバージョンのスナップショット (`.json` ファイル) を選択する。
    2.  「新構造」エリアに、現在開発中の新しいバージョンのモジュールフォルダのパスを指定し、「このフォルダをスキャン」ボタンをクリックする。
    3.  「比較実行」ボタンをクリックすると、ツリービューに差分が表示される。

3.  **レポート作成とドキュメント化**
    1.  比較後、「エクスポート」ボタンで結果をCSVまたはExcelファイルに出力する。
    2.  出力されたファイルを開き、「Description」列に各変更点の説明を追記する。
        *   **(推奨)** ファイルをChatGPTやGeminiにアップロードし、「各行のファイル変更について、リリースノートに記載するような簡潔な説明を'Description'列に記述してください」といったプロンプトで自動生成させる。
    3.  説明を追記したファイルを保存する。
    4.  アプリケーションに戻り、「説明をインポート」ボタンで編集後のファイルを読み込む。
    5.  画面上で、各差分項目に説明が付与された状態でレビューや確認ができる。
